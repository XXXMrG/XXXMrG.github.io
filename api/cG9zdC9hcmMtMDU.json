{"title":"Vue é«˜çº§ï¼ˆVue Router åŸºç¡€ï¼‰","date":"2019-03-21T14:07:11.000Z","link":"post/arc-05","tags":["front_end"],"categories":["å‰ç«¯"],"updated":"2019-03-21T14:08:59.763Z","content":"<hr>\n<h2 id=\"åŠ¨æ€è·¯ç”±åŒ¹é…\">åŠ¨æ€è·¯ç”±åŒ¹é…<a href=\"post/arc-05#åŠ¨æ€è·¯ç”±åŒ¹é…\"></a></h2><p>æˆ‘ä»¬ç»å¸¸éœ€è¦æŠŠæŸç§æ¨¡å¼åŒ¹é…åˆ°çš„æ‰€æœ‰è·¯ç”±ï¼Œå…¨éƒ½æ˜ å°„åˆ°åŒä¸ªç»„ä»¶ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªUserç»„ä»¶ï¼Œå¯¹äºæ‰€æœ‰ ID å„ä¸ç›¸åŒçš„ç”¨æˆ·ï¼Œéƒ½è¦ä½¿ç”¨è¿™ä¸ªç»„ä»¶æ¥æ¸²æŸ“ã€‚</p>\n<div class=\"article-img\"><p><img src=\"https://i.loli.net/2019/03/21/5c939acf2a6c6.png\" alt=\"5c939acf2a6c6.png\" data-zoomable></p></div>\n<h3 id=\"å“åº”è·¯ç”±å‚æ•°çš„å˜åŒ–\">å“åº”è·¯ç”±å‚æ•°çš„å˜åŒ–<a href=\"post/arc-05#å“åº”è·¯ç”±å‚æ•°çš„å˜åŒ–\"></a></h3><blockquote>\n<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ PixelStack ä¸ä¼šåˆ·æ–°ï¼Œæ—©çœ‹äº†è¿™ä¸ªæ—©å°±åˆ·æ–°äº†ã€‚ğŸ˜‚  </p>\n</blockquote>\n<p>æé†’ä¸€ä¸‹ï¼Œå½“ä½¿ç”¨è·¯ç”±å‚æ•°æ—¶ï¼Œä¾‹å¦‚ä»/user/fooå¯¼èˆªåˆ°/user/barï¼Œ<strong>åŸæ¥çš„ç»„ä»¶å®ä¾‹ä¼šè¢«å¤ç”¨</strong>ã€‚å› ä¸ºä¸¤ä¸ªè·¯ç”±éƒ½æ¸²æŸ“åŒä¸ªç»„ä»¶ï¼Œæ¯”èµ·é”€æ¯å†åˆ›å»ºï¼Œå¤ç”¨åˆ™æ˜¾å¾—æ›´åŠ é«˜æ•ˆã€‚<strong>ä¸è¿‡ï¼Œè¿™ä¹Ÿæ„å‘³ç€ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸé’©å­ä¸ä¼šå†è¢«è°ƒç”¨</strong>ã€‚<br>å¤ç”¨ç»„ä»¶æ—¶ï¼Œæƒ³å¯¹è·¯ç”±å‚æ•°çš„å˜åŒ–ä½œå‡ºå“åº”çš„è¯ï¼Œä½ å¯ä»¥ç®€å•åœ° watch (ç›‘æµ‹å˜åŒ–)$routeå¯¹è±¡ï¼š</p>\n<figure class=\"highlight javascript\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> User = &#123;</span><br><span class=\"line\">  template: <span class=\"string\">'...'</span>,</span><br><span class=\"line\">  watch: &#123;</span><br><span class=\"line\">    <span class=\"string\">'$route'</span> (to, <span class=\"keyword\">from</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// å¯¹è·¯ç”±å˜åŒ–ä½œå‡ºå“åº”...</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n<p>æˆ–è€…ä½¿ç”¨ 2.2 ç‰ˆæœ¬ä¸­å¼•å…¥çš„å¯¼èˆªå®ˆå«</p>\n<figure class=\"highlight javascript\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> User = &#123;</span><br><span class=\"line\">  template: <span class=\"string\">'...'</span>,</span><br><span class=\"line\">  beforeRouteUpdate (to, <span class=\"keyword\">from</span>, next) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// react to route changes...</span></span><br><span class=\"line\">    <span class=\"comment\">// don't forget to call next()</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n<h3 id=\"æ•è·æ‰€æœ‰è·¯ç”±æˆ–-404-Not-found-è·¯ç”±\">æ•è·æ‰€æœ‰è·¯ç”±æˆ– 404 Not found è·¯ç”±<a href=\"post/arc-05#æ•è·æ‰€æœ‰è·¯ç”±æˆ–-404-Not-found-è·¯ç”±\"></a></h3><p>å¸¸è§„å‚æ•°åªä¼šåŒ¹é…è¢«/åˆ†éš”çš„ URL ç‰‡æ®µä¸­çš„å­—ç¬¦ã€‚å¦‚æœæƒ³åŒ¹é…<strong>ä»»æ„è·¯å¾„</strong>ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é€šé…ç¬¦ (*)ï¼š</p>\n<p>å½“ä½¿ç”¨<em>é€šé…ç¬¦</em>è·¯ç”±æ—¶ï¼Œè¯·ç¡®ä¿è·¯ç”±çš„é¡ºåºæ˜¯æ­£ç¡®çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å«æœ‰<strong>é€šé…ç¬¦</strong>çš„è·¯ç”±åº”è¯¥æ”¾åœ¨æœ€åã€‚è·¯ç”±{ path: â€˜<em>â€™ }é€šå¸¸ç”¨äºå®¢æˆ·ç«¯ 404 é”™è¯¯ã€‚å¦‚æœä½ ä½¿ç”¨äº†<strong>History æ¨¡å¼</strong>ï¼Œè¯·ç¡®ä¿ <a href=\"https://router.vuejs.org/zh/guide/essentials/history-mode.html\" target=\"_blank\" rel=\"noopener\">æ­£ç¡®é…ç½®ä½ çš„æœåŠ¡å™¨</a> ã€‚<br>å½“ä½¿ç”¨ä¸€ä¸ª</em>é€šé…ç¬¦<em>æ—¶ï¼Œ$route.paramså†…ä¼šè‡ªåŠ¨æ·»åŠ ä¸€ä¸ªåä¸ºpathMatchå‚æ•°ã€‚å®ƒåŒ…å«äº† URL é€šè¿‡</em>é€šé…ç¬¦*è¢«åŒ¹é…çš„éƒ¨åˆ†ï¼š</p>\n<figure class=\"highlight javascript\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ç»™å‡ºä¸€ä¸ªè·¯ç”± &#123; path: '/user-*' &#125;</span></span><br><span class=\"line\"><span class=\"keyword\">this</span>.$router.push(<span class=\"string\">'/user-admin'</span>)</span><br><span class=\"line\"><span class=\"keyword\">this</span>.$route.params.pathMatch <span class=\"comment\">// 'admin'</span></span><br><span class=\"line\"><span class=\"comment\">// ç»™å‡ºä¸€ä¸ªè·¯ç”± &#123; path: '*' &#125;</span></span><br><span class=\"line\"><span class=\"keyword\">this</span>.$router.push(<span class=\"string\">'/non-existing'</span>)</span><br><span class=\"line\"><span class=\"keyword\">this</span>.$route.params.pathMatch <span class=\"comment\">// '/non-existing'</span></span><br></pre></td></tr></table></div></figure>\n<h3 id=\"é«˜çº§åŒ¹é…æ¨¡å¼\">é«˜çº§åŒ¹é…æ¨¡å¼<a href=\"post/arc-05#é«˜çº§åŒ¹é…æ¨¡å¼\"></a></h3><p>vue-routerä½¿ç”¨ <a href=\"https://github.com/pillarjs/path-to-regexp\" target=\"_blank\" rel=\"noopener\">path-to-regexp</a> ä½œä¸ºè·¯å¾„åŒ¹é…å¼•æ“ï¼Œæ‰€ä»¥æ”¯æŒå¾ˆå¤šé«˜çº§çš„åŒ¹é…æ¨¡å¼ï¼Œä¾‹å¦‚ï¼šå¯é€‰çš„åŠ¨æ€è·¯å¾„å‚æ•°ã€åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªã€ä¸€ä¸ªæˆ–å¤šä¸ªï¼Œç”šè‡³æ˜¯è‡ªå®šä¹‰æ­£åˆ™åŒ¹é…ã€‚æŸ¥çœ‹å®ƒçš„ <a href=\"https://github.com/pillarjs/path-to-regexp#parameters\" target=\"_blank\" rel=\"noopener\">æ–‡æ¡£</a> å­¦ä¹ é«˜é˜¶çš„è·¯å¾„åŒ¹é…ï¼Œè¿˜æœ‰ <a href=\"https://github.com/vuejs/vue-router/blob/dev/examples/route-matching/app.js\" target=\"_blank\" rel=\"noopener\">è¿™ä¸ªä¾‹å­</a> å±•ç¤ºvue-routeræ€ä¹ˆä½¿ç”¨è¿™ç±»åŒ¹é…ã€‚</p>\n<h3 id=\"åŒ¹é…ä¼˜å…ˆçº§\">åŒ¹é…ä¼˜å…ˆçº§<a href=\"post/arc-05#åŒ¹é…ä¼˜å…ˆçº§\"></a></h3><p>æœ‰æ—¶å€™ï¼ŒåŒä¸€ä¸ªè·¯å¾„å¯ä»¥åŒ¹é…å¤šä¸ªè·¯ç”±ï¼Œæ­¤æ—¶ï¼ŒåŒ¹é…çš„ä¼˜å…ˆçº§å°±æŒ‰ç…§è·¯ç”±çš„å®šä¹‰é¡ºåºï¼šè°å…ˆå®šä¹‰çš„ï¼Œè°çš„ä¼˜å…ˆçº§å°±æœ€é«˜ã€‚</p>\n<h2 id=\"åµŒå¥—è·¯ç”±\">åµŒå¥—è·¯ç”±<a href=\"post/arc-05#åµŒå¥—è·¯ç”±\"></a></h2><p>è¦åœ¨åµŒå¥—çš„å‡ºå£ä¸­æ¸²æŸ“ç»„ä»¶ï¼Œéœ€è¦åœ¨VueRouterçš„å‚æ•°ä¸­ä½¿ç”¨childrené…ç½®ï¼š</p>\n<figure class=\"highlight javascript\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> router = <span class=\"keyword\">new</span> VueRouter(&#123;</span><br><span class=\"line\">  routes: [</span><br><span class=\"line\">    &#123; <span class=\"attr\">path</span>: <span class=\"string\">'/user/:id'</span>, <span class=\"attr\">component</span>: User,</span><br><span class=\"line\">      children: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          <span class=\"comment\">// å½“ /user/:id/profile åŒ¹é…æˆåŠŸï¼Œ</span></span><br><span class=\"line\">          <span class=\"comment\">// UserProfile ä¼šè¢«æ¸²æŸ“åœ¨ User çš„ &lt;router-view&gt; ä¸­</span></span><br><span class=\"line\">          path: <span class=\"string\">'profile'</span>,</span><br><span class=\"line\">          component: UserProfile</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          <span class=\"comment\">// å½“ /user/:id/posts åŒ¹é…æˆåŠŸ</span></span><br><span class=\"line\">          <span class=\"comment\">// UserPosts ä¼šè¢«æ¸²æŸ“åœ¨ User çš„ &lt;router-view&gt; ä¸­</span></span><br><span class=\"line\">          path: <span class=\"string\">'posts'</span>,</span><br><span class=\"line\">          component: UserPosts</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      ]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></div></figure>\n<p><strong>è¦æ³¨æ„ï¼Œä»¥ / å¼€å¤´çš„åµŒå¥—è·¯å¾„ä¼šè¢«å½“ä½œæ ¹è·¯å¾„ã€‚ è¿™è®©ä½ å……åˆ†çš„ä½¿ç”¨åµŒå¥—ç»„ä»¶è€Œæ— é¡»è®¾ç½®åµŒå¥—çš„è·¯å¾„ã€‚</strong><br>ä½ ä¼šå‘ç°ï¼Œchildrené…ç½®å°±æ˜¯åƒroutesé…ç½®ä¸€æ ·çš„è·¯ç”±é…ç½®æ•°ç»„ï¼Œæ‰€ä»¥å‘¢ï¼Œä½ å¯ä»¥åµŒå¥—å¤šå±‚è·¯ç”±ã€‚<br>æ­¤æ—¶ï¼ŒåŸºäºä¸Šé¢çš„é…ç½®ï¼Œå½“ä½ è®¿é—®/user/fooæ—¶ï¼ŒUserçš„å‡ºå£æ˜¯ä¸ä¼šæ¸²æŸ“ä»»ä½•ä¸œè¥¿ï¼Œè¿™æ˜¯å› ä¸ºæ²¡æœ‰åŒ¹é…åˆ°åˆé€‚çš„å­è·¯ç”±ã€‚å¦‚æœä½ æƒ³è¦æ¸²æŸ“ç‚¹ä»€ä¹ˆï¼Œå¯ä»¥æä¾›ä¸€ä¸ª ç©ºçš„ å­è·¯ç”±ï¼š</p>\n<figure class=\"highlight javascript\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> router = <span class=\"keyword\">new</span> VueRouter(&#123;</span><br><span class=\"line\">  routes: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      path: <span class=\"string\">'/user/:id'</span>, <span class=\"attr\">component</span>: User,</span><br><span class=\"line\">      children: [</span><br><span class=\"line\">        <span class=\"comment\">// å½“ /user/:id åŒ¹é…æˆåŠŸï¼Œ</span></span><br><span class=\"line\">        <span class=\"comment\">// UserHome ä¼šè¢«æ¸²æŸ“åœ¨ User çš„ &lt;router-view&gt; ä¸­</span></span><br><span class=\"line\">        &#123; <span class=\"attr\">path</span>: <span class=\"string\">''</span>, <span class=\"attr\">component</span>: UserHome &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// ...å…¶ä»–å­è·¯ç”±</span></span><br><span class=\"line\">      ]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></div></figure>\n<h2 id=\"ç¼–ç¨‹å¼çš„å¯¼èˆª\">ç¼–ç¨‹å¼çš„å¯¼èˆª<a href=\"post/arc-05#ç¼–ç¨‹å¼çš„å¯¼èˆª\"></a></h2><p>é™¤äº†ä½¿ç”¨ <router-link> æ ‡ç­¾æ¥å®šä¹‰å¯¼èˆªè¿æ¥ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å€ŸåŠ© router çš„å®ä¾‹æ–¹æ³•ï¼Œé€šè¿‡ç¼–å†™ä»£ç æ¥å®ç°ã€‚<br>å¸¸ç”¨çš„æ–¹æ³•æœ‰ä¸‰ä¸ª</router-link></p>\n<p><code>router.push(location, onComplete?, onAbort?)</code></p>\n<p>æƒ³è¦å¯¼èˆªåˆ°ä¸åŒçš„ URLï¼Œåˆ™ä½¿ç”¨router.pushæ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ä¼šå‘ history æ ˆæ·»åŠ ä¸€ä¸ªæ–°çš„è®°å½•ï¼Œæ‰€ä»¥ï¼Œå½“ç”¨æˆ·ç‚¹å‡»æµè§ˆå™¨åé€€æŒ‰é’®æ—¶ï¼Œåˆ™å›åˆ°ä¹‹å‰çš„ URLã€‚<br>å½“ä½ ç‚¹å‡»<router-link>æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šåœ¨å†…éƒ¨è°ƒç”¨ï¼Œæ‰€ä»¥è¯´ï¼Œç‚¹å‡»<router-link :to=\"â€œâ€¦â€\">ç­‰åŒäºè°ƒç”¨router.push(â€¦)ã€‚<br>è¯¥æ–¹æ³•çš„å‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²è·¯å¾„ï¼Œæˆ–è€…ä¸€ä¸ªæè¿°åœ°å€çš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼š</router-link></router-link></p>\n<figure class=\"highlight javascript\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å­—ç¬¦ä¸²</span></span><br><span class=\"line\">router.push(<span class=\"string\">'home'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å¯¹è±¡</span></span><br><span class=\"line\">router.push(&#123; <span class=\"attr\">path</span>: <span class=\"string\">'home'</span> &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å‘½åçš„è·¯ç”±</span></span><br><span class=\"line\">router.push(&#123; <span class=\"attr\">name</span>: <span class=\"string\">'user'</span>, <span class=\"attr\">params</span>: &#123; <span class=\"attr\">userId</span>: <span class=\"string\">'123'</span> &#125;&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å¸¦æŸ¥è¯¢å‚æ•°ï¼Œå˜æˆ /register?plan=private</span></span><br><span class=\"line\">router.push(&#123; <span class=\"attr\">path</span>: <span class=\"string\">'register'</span>, <span class=\"attr\">query</span>: &#123; <span class=\"attr\">plan</span>: <span class=\"string\">'private'</span> &#125;&#125;)</span><br></pre></td></tr></table></div></figure>\n<p><strong>æ³¨æ„ï¼šå¦‚æœæä¾›äº†pathï¼Œparamsä¼šè¢«å¿½ç•¥ï¼Œä¸Šè¿°ä¾‹å­ä¸­çš„queryå¹¶ä¸å±äºè¿™ç§æƒ…å†µã€‚å–è€Œä»£ä¹‹çš„æ˜¯ä¸‹é¢ä¾‹å­çš„åšæ³•ï¼Œä½ éœ€è¦æä¾›è·¯ç”±çš„nameæˆ–æ‰‹å†™å®Œæ•´çš„å¸¦æœ‰å‚æ•°çš„pathï¼š</strong></p>\n<figure class=\"highlight javascript\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> userId = <span class=\"string\">'123'</span></span><br><span class=\"line\">router.push(&#123; <span class=\"attr\">name</span>: <span class=\"string\">'user'</span>, <span class=\"attr\">params</span>: &#123; userId &#125;&#125;) <span class=\"comment\">// -&gt; /user/123</span></span><br><span class=\"line\">router.push(&#123; <span class=\"attr\">path</span>: <span class=\"string\">`/user/<span class=\"subst\">$&#123;userId&#125;</span>`</span> &#125;) <span class=\"comment\">// -&gt; /user/123</span></span><br><span class=\"line\"><span class=\"comment\">// è¿™é‡Œçš„ params ä¸ç”Ÿæ•ˆ</span></span><br><span class=\"line\">router.push(&#123; <span class=\"attr\">path</span>: <span class=\"string\">'/user'</span>, <span class=\"attr\">params</span>: &#123; userId &#125;&#125;) <span class=\"comment\">// -&gt; /user</span></span><br></pre></td></tr></table></div></figure>\n<p>åŒæ ·çš„è§„åˆ™ä¹Ÿé€‚ç”¨äºrouter-linkç»„ä»¶çš„toå±æ€§ã€‚<br>åœ¨ 2.2.0+ï¼Œå¯é€‰çš„åœ¨router.pushæˆ–router.replaceä¸­æä¾›onCompleteå’ŒonAbortå›è°ƒä½œä¸ºç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°ã€‚è¿™äº›å›è°ƒå°†ä¼šåœ¨å¯¼èˆªæˆåŠŸå®Œæˆ (åœ¨æ‰€æœ‰çš„å¼‚æ­¥é’©å­è¢«è§£æä¹‹å) æˆ–ç»ˆæ­¢ (å¯¼èˆªåˆ°ç›¸åŒçš„è·¯ç”±ã€æˆ–åœ¨å½“å‰å¯¼èˆªå®Œæˆä¹‹å‰å¯¼èˆªåˆ°å¦ä¸€ä¸ªä¸åŒçš„è·¯ç”±) çš„æ—¶å€™è¿›è¡Œç›¸åº”çš„è°ƒç”¨ã€‚<br><strong>æ³¨æ„</strong>ï¼š å¦‚æœç›®çš„åœ°å’Œå½“å‰è·¯ç”±ç›¸åŒï¼Œåªæœ‰å‚æ•°å‘ç”Ÿäº†æ”¹å˜ (æ¯”å¦‚ä»ä¸€ä¸ªç”¨æˆ·èµ„æ–™åˆ°å¦ä¸€ä¸ª/users/1-&gt;/users/2)ï¼Œä½ éœ€è¦ä½¿ç”¨ <a href=\"https://router.vuejs.org/zh/guide/essentials/dynamic-matching.html#%E5%93%8D%E5%BA%94%E8%B7%AF%E7%94%B1%E5%8F%82%E6%95%B0%E7%9A%84%E5%8F%98%E5%8C%96\" target=\"_blank\" rel=\"noopener\">beforeRouteUpdate</a> æ¥å“åº”è¿™ä¸ªå˜åŒ– (æ¯”å¦‚æŠ“å–ç”¨æˆ·ä¿¡æ¯)ã€‚</p>\n<p><code>router.replace(location, onComplete?, onAbort?)</code></p>\n<p>è·Ÿrouter.pushå¾ˆåƒï¼Œå”¯ä¸€çš„ä¸åŒå°±æ˜¯ï¼Œå®ƒä¸ä¼šå‘ history æ·»åŠ æ–°è®°å½•ï¼Œè€Œæ˜¯è·Ÿå®ƒçš„æ–¹æ³•åä¸€æ · â€”â€” æ›¿æ¢æ‰å½“å‰çš„ history è®°å½•ã€‚</p>\n<p><code>router.go(n)</code></p>\n<p>è¿™ä¸ªæ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œæ„æ€æ˜¯åœ¨ history è®°å½•ä¸­å‘å‰æˆ–è€…åé€€å¤šå°‘æ­¥ï¼Œç±»ä¼¼window.history.go(n)ã€‚</p>\n<figure class=\"highlight javascript\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// åœ¨æµè§ˆå™¨è®°å½•ä¸­å‰è¿›ä¸€æ­¥ï¼Œç­‰åŒäº history.forward()</span></span><br><span class=\"line\">router.go(<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// åé€€ä¸€æ­¥è®°å½•ï¼Œç­‰åŒäº history.back()</span></span><br><span class=\"line\">router.go(<span class=\"number\">-1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å‰è¿› 3 æ­¥è®°å½•</span></span><br><span class=\"line\">router.go(<span class=\"number\">3</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å¦‚æœ history è®°å½•ä¸å¤Ÿç”¨ï¼Œé‚£å°±é»˜é»˜åœ°å¤±è´¥å‘—</span></span><br><span class=\"line\">router.go(<span class=\"number\">-100</span>)</span><br><span class=\"line\">router.go(<span class=\"number\">100</span>)</span><br></pre></td></tr></table></div></figure>\n<p> ä½ ä¹Ÿè®¸æ³¨æ„åˆ°router.push ã€router.replace å’Œrouter.goè·Ÿ <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/History\" target=\"_blank\" rel=\"noopener\">window.history.pushStateã€window.history.replaceStateå’Œwindow.history.go</a>  å¥½åƒï¼Œ å®é™…ä¸Šå®ƒä»¬ç¡®å®æ˜¯æ•ˆä»¿window.historyAPI çš„ã€‚<br>å› æ­¤ï¼Œå¦‚æœä½ å·²ç»ç†Ÿæ‚‰Browser History APIs <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/History_API\" target=\"_blank\" rel=\"noopener\">Browser History APIs</a>ï¼Œé‚£ä¹ˆåœ¨ Vue Router ä¸­æ“ä½œ history å°±æ˜¯è¶…çº§ç®€å•çš„ã€‚è¿˜æœ‰å€¼å¾—æåŠçš„ï¼ŒVue Router çš„å¯¼èˆªæ–¹æ³• (pushã€replace ã€go ) åœ¨å„ç±»è·¯ç”±æ¨¡å¼ (history ã€hashå’Œabstract ) ä¸‹è¡¨ç°ä¸€è‡´ã€‚</p>\n<h2 id=\"é‡å®šå‘å’Œåˆ«å\">é‡å®šå‘å’Œåˆ«å<a href=\"post/arc-05#é‡å®šå‘å’Œåˆ«å\"></a></h2><p>é‡å®šå‘ä¹Ÿæ˜¯é€šè¿‡routesé…ç½®æ¥å®Œæˆï¼Œä¸‹é¢ä¾‹å­æ˜¯ä»/aé‡å®šå‘åˆ°/bï¼š</p>\n<figure class=\"highlight javascript\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> router = <span class=\"keyword\">new</span> VueRouter(&#123;</span><br><span class=\"line\">  routes: [</span><br><span class=\"line\">    \t&#123; <span class=\"attr\">path</span>: <span class=\"string\">'/a'</span>, <span class=\"attr\">redirect</span>: <span class=\"string\">'/b'</span> &#125;,</span><br><span class=\"line\">\t\t&#123; <span class=\"attr\">path</span>: <span class=\"string\">'/a'</span>, <span class=\"attr\">redirect</span>: &#123; <span class=\"attr\">name</span>: <span class=\"string\">'foo'</span> &#125;&#125;,</span><br><span class=\"line\">    \t&#123; <span class=\"attr\">path</span>: <span class=\"string\">'/a'</span>, <span class=\"attr\">redirect</span>: <span class=\"function\"><span class=\"params\">to</span> =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"comment\">// æ–¹æ³•æ¥æ”¶ ç›®æ ‡è·¯ç”± ä½œä¸ºå‚æ•°</span></span><br><span class=\"line\">      <span class=\"comment\">// return é‡å®šå‘çš„ å­—ç¬¦ä¸²è·¯å¾„/è·¯å¾„å¯¹è±¡</span></span><br><span class=\"line\">    \t&#125;&#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></div></figure>\n<p><strong>æ³¨æ„ï¼Œå¯¼èˆªå®ˆå«å¹¶æ²¡æœ‰åº”ç”¨åœ¨è·³è½¬è·¯ç”±ä¸Šï¼Œè€Œä»…ä»…åº”ç”¨åœ¨å…¶ç›®æ ‡ä¸Šï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¸º /a è·¯ç”±æ·»åŠ beforeEach æˆ– beforeLeave å®ˆå«å¹¶ä¸ä¼šæœ‰ä»»ä½•æ•ˆæœã€‚</strong></p>\n<h2 id=\"è·¯ç”±ç»„ä»¶ä¼ å‚\">è·¯ç”±ç»„ä»¶ä¼ å‚<a href=\"post/arc-05#è·¯ç”±ç»„ä»¶ä¼ å‚\"></a></h2><p>åœ¨ç»„ä»¶ä¸­ä½¿ç”¨$routeä¼šä½¿ä¹‹ä¸å…¶å¯¹åº”è·¯ç”±å½¢æˆé«˜åº¦è€¦åˆï¼Œä»è€Œä½¿ç»„ä»¶åªèƒ½åœ¨æŸäº›ç‰¹å®šçš„ URL ä¸Šä½¿ç”¨ï¼Œé™åˆ¶äº†å…¶çµæ´»æ€§ã€‚</p>\n<p><strong>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ props å°†å…¶æ¥è€¦</strong></p>\n<p>å¦‚æœ<code>rops</code>è¢«è®¾ç½®ä¸º<code>true</code> ï¼Œ<code>route.params</code> å°†ä¼šè¢«è®¾ç½®ä¸ºç»„ä»¶å±æ€§ã€‚</p>\n<figure class=\"highlight javascript\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> User = &#123;</span><br><span class=\"line\">  props: [<span class=\"string\">'id'</span>],</span><br><span class=\"line\">  template: <span class=\"string\">'&lt;div&gt;User &#123;&#123; id &#125;&#125;&lt;/div&gt;'</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">const</span> router = <span class=\"keyword\">new</span> VueRouter(&#123;</span><br><span class=\"line\">  routes: [</span><br><span class=\"line\">    &#123; <span class=\"attr\">path</span>: <span class=\"string\">'/user/:id'</span>, <span class=\"attr\">component</span>: User, <span class=\"attr\">props</span>: <span class=\"literal\">true</span> &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// å¯¹äºåŒ…å«å‘½åè§†å›¾çš„è·¯ç”±ï¼Œä½ å¿…é¡»åˆ†åˆ«ä¸ºæ¯ä¸ªå‘½åè§†å›¾æ·»åŠ  `props` é€‰é¡¹ï¼š</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      path: <span class=\"string\">'/user/:id'</span>,</span><br><span class=\"line\">      components: &#123; <span class=\"attr\">default</span>: User, <span class=\"attr\">sidebar</span>: Sidebar &#125;,</span><br><span class=\"line\">      props: &#123; <span class=\"attr\">default</span>: <span class=\"literal\">true</span>, <span class=\"attr\">sidebar</span>: <span class=\"literal\">false</span> &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></div></figure>\n<h2 id=\"HTML-5-History-æ¨¡å¼\">HTML 5 History æ¨¡å¼<a href=\"post/arc-05#HTML-5-History-æ¨¡å¼\"></a></h2><div class=\"article-img\"><p><img src=\"https://i.loli.net/2019/03/21/5c939ae26be08.png\" alt=\"5c939ae26be08.png\" data-zoomable></p></div>\n","prev":{"title":"æ­£åˆ™è¡¨è¾¾å¼è¯¦è§£ï¼ˆJavaScript æè¿°ï¼‰","link":"post/arc-06"},"next":{"title":"TCP or UDP ?","link":"post/arc-04"},"plink":"https://xkeith.space/post/arc-05/","toc":[{"title":"åŠ¨æ€è·¯ç”±åŒ¹é…","id":"åŠ¨æ€è·¯ç”±åŒ¹é…","index":"1","children":[{"title":"å“åº”è·¯ç”±å‚æ•°çš„å˜åŒ–","id":"å“åº”è·¯ç”±å‚æ•°çš„å˜åŒ–","index":"1.1"},{"title":"æ•è·æ‰€æœ‰è·¯ç”±æˆ– 404 Not found è·¯ç”±","id":"æ•è·æ‰€æœ‰è·¯ç”±æˆ–-404-Not-found-è·¯ç”±","index":"1.2"},{"title":"é«˜çº§åŒ¹é…æ¨¡å¼","id":"é«˜çº§åŒ¹é…æ¨¡å¼","index":"1.3"},{"title":"åŒ¹é…ä¼˜å…ˆçº§","id":"åŒ¹é…ä¼˜å…ˆçº§","index":"1.4"}]},{"title":"åµŒå¥—è·¯ç”±","id":"åµŒå¥—è·¯ç”±","index":"2"},{"title":"ç¼–ç¨‹å¼çš„å¯¼èˆª","id":"ç¼–ç¨‹å¼çš„å¯¼èˆª","index":"3"},{"title":"é‡å®šå‘å’Œåˆ«å","id":"é‡å®šå‘å’Œåˆ«å","index":"4"},{"title":"è·¯ç”±ç»„ä»¶ä¼ å‚","id":"è·¯ç”±ç»„ä»¶ä¼ å‚","index":"5"},{"title":"HTML 5 History æ¨¡å¼","id":"HTML-5-History-æ¨¡å¼","index":"6"}]}