{"title":"手撕 BFC","date":"2019-04-29T13:53:18.000Z","link":"post/arc-19","tags":["front_end"],"categories":["前端"],"updated":"2019-04-29T13:56:47.858Z","content":"<hr>\n<blockquote>\n<p>BFC就是页面上的一个隔离的独立容器，容器里面的子元素不会影响到外面的元素。反之也如此。</p>\n</blockquote>\n<h2 id=\"概念\">概念<a href=\"post/arc-19#概念\"></a></h2><p><strong>块格式化上下文（Block Formatting Context，BFC）</strong>是Web页面的可视化CSS渲染的一部分，是块盒子的布局过程发生的区域，也是浮动元素与其他元素交互的区域。</p>\n<h3 id=\"创建\">创建<a href=\"post/arc-19#创建\"></a></h3><p>下列方式会创建<strong>块格式化上下文</strong>：</p>\n<ul>\n<li>根元素或包含根元素的元素</li>\n<li>浮动元素（元素的 <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/float\" target=\"_blank\" rel=\"noopener\">float</a> 不是none）</li>\n<li>绝对定位元素（元素的 <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/position\" target=\"_blank\" rel=\"noopener\">position</a> 为absolute或fixed）</li>\n<li>行内块元素（元素的 <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/display\" target=\"_blank\" rel=\"noopener\">display</a> 为inline-block）</li>\n<li>表格单元格（元素的 <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/display\" target=\"_blank\" rel=\"noopener\">display</a> 为table-cell，HTML表格单元格默认为该值）</li>\n<li>表格标题（元素的 <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/display\" target=\"_blank\" rel=\"noopener\">display</a> 为table-caption，HTML表格标题默认为该值）</li>\n<li>匿名表格单元格元素（元素的 <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/display\" target=\"_blank\" rel=\"noopener\">display</a> 为table、table-row、table-row-group、table-header-group、table-footer-group（分别是HTML table、row、tbody、thead、tfoot的默认属性）或inline-table）</li>\n<li><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/overflow\" target=\"_blank\" rel=\"noopener\">overflow</a> 值不为visible的块元素</li>\n<li><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/display\" target=\"_blank\" rel=\"noopener\">display</a> 值为 <a href=\"https://drafts.csswg.org/css-display/#valdef-display-flow-root\" target=\"_blank\" rel=\"noopener\">flow-root</a> 的元素（⚠️ 这样的 BFC 是没有任何副作用的，但要考虑使用时候的兼容性和实际应用场景）</li>\n<li><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/contain\" target=\"_blank\" rel=\"noopener\">contain</a> 值为layout、content或strict的元素</li>\n<li>弹性元素（ <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/display\" target=\"_blank\" rel=\"noopener\">display</a> 为flex或inline-flex元素的直接子元素）</li>\n<li>网格元素（ <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/display\" target=\"_blank\" rel=\"noopener\">display</a> 为grid或inline-grid元素的直接子元素）</li>\n<li>多列容器（元素的 <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/column-count\" target=\"_blank\" rel=\"noopener\">column-count</a> 或 <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/column-width\" target=\"_blank\" rel=\"noopener\">column-width</a> 不为auto，包括column-count为1）</li>\n<li>column-span为all的元素始终会创建一个新的BFC，即使该元素没有包裹在一个多列容器中（ <a href=\"https://github.com/w3c/csswg-drafts/commit/a8634b96900279916bd6c505fda88dda71d8ec51\" target=\"_blank\" rel=\"noopener\">标准变更</a> ， <a href=\"https://bugs.chromium.org/p/chromium/issues/detail?id=709362\" target=\"_blank\" rel=\"noopener\">Chromebug</a> ）。<br>块格式化上下文包含创建它的元素内部的所有内容.<br>块格式化上下文对浮动定位（参见 <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/float\" target=\"_blank\" rel=\"noopener\">float</a> ）与清除浮动（参见 <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/clear\" target=\"_blank\" rel=\"noopener\">clear</a> ）都很重要。浮动定位和清除浮动时只会应用于同一个BFC内的元素。浮动不会影响其它BFC中元素的布局，而清除浮动只能清除同一BFC中在它前面的元素的浮动。外边距折叠（ <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Box_Model/Mastering_margin_collapsing\" target=\"_blank\" rel=\"noopener\">Margin collapsing</a> ）也只会发生在属于同一BFC的块级元素之间。</li>\n</ul>\n<h3 id=\"约束规则\">约束规则<a href=\"post/arc-19#约束规则\"></a></h3><ul>\n<li>内部的Box会在垂直方向上一个接一个的放置</li>\n<li>垂直方向上的距离由margin决定。（完整的说法是：属于同一个BFC的两个相邻Box的margin会发生重叠（塌陷），与方向无关。）</li>\n<li>每个元素的左外边距与包含块的左边界相接触（从左向右），即使浮动元素也是如此。（这说明BFC中子元素不会超出他的包含块，而position为absolute的元素可以超出他的包含块边界）</li>\n<li>BFC的区域不会与float的元素区域重叠</li>\n<li>计算BFC的高度时，浮动子元素也参与计算</li>\n<li>BFC就是页面上的一个隔离的独立容器，容器里面的子元素不会影响到外面元素，反之亦然</li>\n</ul>\n<p>看到以上的几条约束，想想我们学习css时的几条规则</p>\n<ul>\n<li>Block元素会扩展到与父元素同宽，所以block元素会垂直排列</li>\n<li>垂直方向上的两个相邻DIV的margin会重叠，而水平方向不会(此规则并不完全正确)</li>\n<li>浮动元素会尽量接近往左上方（或右上方）</li>\n<li>为父元素设置overflow：hidden或浮动父元素，则会包含浮动元素</li>\n</ul>\n<h2 id=\"主要应用\">主要应用<a href=\"post/arc-19#主要应用\"></a></h2><h3 id=\"清除浮动\">清除浮动<a href=\"post/arc-19#清除浮动\"></a></h3><p>根据 BFC 规则：<br> <em>计算BFC的高度时，浮动元素也参与计算</em><br>因此我们可以通过生成 BFC 来处理内部元素产生浮动后出现的原模型高度塌陷问题。</p>\n<figure class=\"highlight html\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">style</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"css\">    <span class=\"selector-class\">.par</span> &#123;</span></span><br><span class=\"line\"><span class=\"css\">        <span class=\"selector-tag\">border</span>: 5<span class=\"selector-tag\">px</span> <span class=\"selector-tag\">solid</span> <span class=\"selector-id\">#fcc</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">        width: 300px;</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"> </span></span><br><span class=\"line\"><span class=\"css\">    <span class=\"selector-class\">.child</span> &#123;</span></span><br><span class=\"line\"><span class=\"css\">        <span class=\"selector-tag\">border</span>: 5<span class=\"selector-tag\">px</span> <span class=\"selector-tag\">solid</span> <span class=\"selector-id\">#f66</span>;</span></span><br><span class=\"line\"><span class=\"css\">        <span class=\"selector-tag\">width</span><span class=\"selector-pseudo\">:100px</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">        height: 100px;</span></span><br><span class=\"line\"><span class=\"undefined\">        float: left;</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">style</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"par\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"child\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"child\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<div class=\"article-img\"><p><img src=\"https://i.loli.net/2019/04/29/5cc70214478b6.png\" alt=\"5cc70214478b6.png\" data-zoomable></p></div>\n<p>为达到清除内部浮动，我们可以触发par生成BFC，那么par在计算高度时，par内部的浮动元素child也会参与计算。</p>\n<figure class=\"highlight css\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.par</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">overflow</span>: hidden;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n<div class=\"article-img\"><p><img src=\"https://i.loli.net/2019/04/29/5cc70220027ec.png\" alt=\"5cc70220027ec.png\" data-zoomable></p></div>\n<h3 id=\"防止-margin-塌陷\">防止 margin 塌陷<a href=\"post/arc-19#防止-margin-塌陷\"></a></h3><h4 id=\"单个文档流的-margin-塌陷\">单个文档流的 margin 塌陷<a href=\"post/arc-19#单个文档流的-margin-塌陷\"></a></h4><p>在普通的文档流盒模型中，两个相邻的块级元素的 margin 会产生塌陷，实际上的外边距的大小是等于两者的 margin 中的最大值的，两个盒之间会产生范围覆盖，也就是 margin 塌陷。</p>\n<figure class=\"highlight html\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">style</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"undefined\">    p &#123;</span></span><br><span class=\"line\"><span class=\"css\">        <span class=\"selector-tag\">color</span>: <span class=\"selector-id\">#f55</span>;</span></span><br><span class=\"line\"><span class=\"css\">        <span class=\"selector-tag\">background</span>: <span class=\"selector-id\">#fcc</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">        width: 200px;</span></span><br><span class=\"line\"><span class=\"undefined\">        line-height: 100px;</span></span><br><span class=\"line\"><span class=\"css\">        <span class=\"selector-tag\">text-align</span><span class=\"selector-pseudo\">:center</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">        margin: 100px;</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">style</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Haha<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Hehe<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<div class=\"article-img\"><p><img src=\"https://i.loli.net/2019/04/29/5cc70235f003a.png\" alt=\"5cc70235f003a.png\" data-zoomable></p></div>\n<p>根据 BFC 规则：<em>Box垂直方向的距离由margin决定。属于同一个BFC(上例中是body根元素的BFC)的两个相邻Box的margin会发生重叠</em><br>我们可以通过生成 BFC 来解决 margin 塌陷。</p>\n<figure class=\"highlight html\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">style</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"css\">    <span class=\"selector-class\">.wrap</span> &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">        overflow: hidden;// 新的BFC</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">    p &#123;</span></span><br><span class=\"line\"><span class=\"css\">        <span class=\"selector-tag\">color</span>: <span class=\"selector-id\">#f55</span>;</span></span><br><span class=\"line\"><span class=\"css\">        <span class=\"selector-tag\">background</span>: <span class=\"selector-id\">#fcc</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">        width: 200px;</span></span><br><span class=\"line\"><span class=\"undefined\">        line-height: 100px;</span></span><br><span class=\"line\"><span class=\"css\">        <span class=\"selector-tag\">text-align</span><span class=\"selector-pseudo\">:center</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">        margin: 100px;</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">style</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Haha<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"wrap\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Hehe<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<div class=\"article-img\"><p><img src=\"https://i.loli.net/2019/04/29/5cc7023ca5451.png\" alt=\"5cc7023ca5451.png\" data-zoomable></p></div>\n<h4 id=\"嵌套元素的-margin-重叠\">嵌套元素的 margin 重叠<a href=\"post/arc-19#嵌套元素的-margin-重叠\"></a></h4><figure class=\"highlight html\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span>  </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span> </span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">\"Content-Type\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"text/html; charset=utf-8\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!--The viewport meta tag is used to improve the presentation and behavior of the samples </span></span><br><span class=\"line\"><span class=\"comment\">    on iOS devices--&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"initial-scale=1, maximum-scale=1,user-scalable=no\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">style</span>&gt;</span><span class=\"undefined\"> </span></span><br><span class=\"line\"><span class=\"css\">    <span class=\"selector-tag\">html</span>, <span class=\"selector-tag\">body</span> &#123; <span class=\"attribute\">height</span>: <span class=\"number\">100%</span>; <span class=\"attribute\">width</span>: <span class=\"number\">100%</span>; <span class=\"attribute\">margin</span>: <span class=\"number\">0</span>; <span class=\"attribute\">padding</span>: <span class=\"number\">0</span>; &#125;</span></span><br><span class=\"line\"><span class=\"css\">    <span class=\"selector-id\">#map</span>&#123;</span></span><br><span class=\"line\"><span class=\"css\">      <span class=\"selector-tag\">padding</span><span class=\"selector-pseudo\">:0</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"css\">    <span class=\"selector-class\">.first</span>&#123;</span></span><br><span class=\"line\"><span class=\"css\">      <span class=\"selector-tag\">margin</span><span class=\"selector-pseudo\">:20px</span>;</span></span><br><span class=\"line\"><span class=\"css\">      <span class=\"selector-tag\">background</span><span class=\"selector-pseudo\">:lightgreen</span>;</span></span><br><span class=\"line\"><span class=\"css\">      <span class=\"selector-tag\">width</span><span class=\"selector-pseudo\">:100px</span>;</span></span><br><span class=\"line\"><span class=\"css\">      <span class=\"selector-tag\">height</span><span class=\"selector-pseudo\">:100px</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">    ul&#123;</span></span><br><span class=\"line\"><span class=\"css\">      <span class=\"comment\">/*display:inline-block;*/</span></span></span><br><span class=\"line\"><span class=\"css\">      <span class=\"selector-tag\">margin</span><span class=\"selector-pseudo\">:10px</span>;</span></span><br><span class=\"line\"><span class=\"css\">      <span class=\"selector-tag\">background</span><span class=\"selector-pseudo\">:lightblue</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">    li&#123;</span></span><br><span class=\"line\"><span class=\"css\">      <span class=\"selector-tag\">margin</span><span class=\"selector-pseudo\">:25px</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">  </span><span class=\"tag\">&lt;/<span class=\"name\">style</span>&gt;</span> </span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span> </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span> <span class=\"attr\">class</span>=<span class=\"string\">\"claro\"</span>&gt;</span> </span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"first\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span>2<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span>3<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span> </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<p><strong>此时div与ul之间的垂直距离，取div、ul、li三者之间的最大外边距。</strong></p>\n<div class=\"article-img\"><p><img src=\"https://i.loli.net/2019/04/29/5cc702493c7b7.png\" alt=\"5cc702493c7b7.png\" data-zoomable></p></div>\n<p>要阻止嵌套元素的margin重叠，只需让ul生成BFC即可（将上例中的注释去掉），这样div、ul、li之间便不会发生重叠现象。</p>\n<div class=\"article-img\"><p><img src=\"https://i.loli.net/2019/04/29/5cc702581978c.png\" alt=\"5cc702581978c.png\" data-zoomable></p></div>\n<p>而li位于同一BFC内所以仍然存在重叠现象。</p>\n<div class=\"article-img\"><p><img src=\"https://i.loli.net/2019/04/29/5cc7025f12c16.png\" alt=\"5cc7025f12c16.png\" data-zoomable></p></div>\n<p>给li设置line-block重新生成一个bfc就不存在重叠现象了。</p>\n<div class=\"article-img\"><p><img src=\"https://i.loli.net/2019/04/29/5cc70266610b9.png\" alt=\"5cc70266610b9.png\" data-zoomable></p></div>\n<p>需要注意的是：<br>如果为ul设置了border或padding，那元素的margin便会被包含在父元素的盒式模型内，不会与外部div重叠。</p>\n<div class=\"article-img\"><p><img src=\"https://i.loli.net/2019/04/29/5cc702702c1cc.png\" alt=\"5cc702702c1cc.png\" data-zoomable></p></div>\n<h3 id=\"自适应布局\">自适应布局<a href=\"post/arc-19#自适应布局\"></a></h3><figure class=\"highlight html\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">style</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"undefined\">    body &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">        width: 300px;</span></span><br><span class=\"line\"><span class=\"undefined\">        position: relative;</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"> </span></span><br><span class=\"line\"><span class=\"css\">    <span class=\"selector-class\">.aside</span> &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">        width: 100px;</span></span><br><span class=\"line\"><span class=\"undefined\">        height: 150px;</span></span><br><span class=\"line\"><span class=\"undefined\">        float: left;</span></span><br><span class=\"line\"><span class=\"css\">        <span class=\"selector-tag\">background</span>: <span class=\"selector-id\">#f66</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"> </span></span><br><span class=\"line\"><span class=\"css\">    <span class=\"selector-class\">.main</span> &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">        height: 200px;</span></span><br><span class=\"line\"><span class=\"css\">        <span class=\"selector-tag\">background</span>: <span class=\"selector-id\">#fcc</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">style</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"aside\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"main\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<div class=\"article-img\"><p><img src=\"https://i.loli.net/2019/04/29/5cc7028d8405f.png\" alt=\"5cc7028d8405f.png\" data-zoomable></p></div>\n<p><em>BFC 的区域不会与浮动区域重叠</em></p>\n<p>我们利用 BFC 的元素不会与外界元素互相影响布局的特性，可以做出自适应的两栏布局。</p>\n<figure class=\"highlight html\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span>  </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span> </span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">\"Content-Type\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"text/html; charset=utf-8\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!--The viewport meta tag is used to improve the presentation and behavior of the samples </span></span><br><span class=\"line\"><span class=\"comment\">    on iOS devices--&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"initial-scale=1, maximum-scale=1,user-scalable=no\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">style</span>&gt;</span><span class=\"undefined\"> </span></span><br><span class=\"line\"><span class=\"css\">    <span class=\"selector-tag\">html</span>, <span class=\"selector-tag\">body</span> &#123; <span class=\"attribute\">height</span>: <span class=\"number\">100%</span>; <span class=\"attribute\">width</span>: <span class=\"number\">100%</span>; <span class=\"attribute\">margin</span>: <span class=\"number\">0</span>; <span class=\"attribute\">padding</span>: <span class=\"number\">0</span>; &#125;</span></span><br><span class=\"line\"><span class=\"css\">    <span class=\"selector-class\">.left</span>&#123;</span></span><br><span class=\"line\"><span class=\"css\">      <span class=\"selector-tag\">background</span><span class=\"selector-pseudo\">:pink</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">      float: left;</span></span><br><span class=\"line\"><span class=\"css\">      <span class=\"selector-tag\">width</span><span class=\"selector-pseudo\">:180px</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"css\">    <span class=\"selector-class\">.center</span>&#123;</span></span><br><span class=\"line\"><span class=\"css\">      <span class=\"selector-tag\">background</span><span class=\"selector-pseudo\">:lightyellow</span>;</span></span><br><span class=\"line\"><span class=\"css\">      <span class=\"selector-tag\">overflow</span><span class=\"selector-pseudo\">:hidden</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">      </span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"css\">    <span class=\"selector-class\">.right</span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">      background: lightblue;</span></span><br><span class=\"line\"><span class=\"css\">      <span class=\"selector-tag\">width</span><span class=\"selector-pseudo\">:180px</span>;</span></span><br><span class=\"line\"><span class=\"css\">      <span class=\"selector-tag\">float</span><span class=\"selector-pseudo\">:right</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">  </span><span class=\"tag\">&lt;/<span class=\"name\">style</span>&gt;</span> </span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span> </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span> <span class=\"attr\">class</span>=<span class=\"string\">\"claro\"</span>&gt;</span> </span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"container\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"left\"</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span></span><br><span class=\"line\">  .left&#123;</span><br><span class=\"line\">    background:pink;</span><br><span class=\"line\">    float: left;</span><br><span class=\"line\">    width:180px;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"right\"</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span></span><br><span class=\"line\">  .right&#123;</span><br><span class=\"line\">    background:lightblue;</span><br><span class=\"line\">    width:180px;</span><br><span class=\"line\">    float:right;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"center\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span></span><br><span class=\"line\">  .center&#123;</span><br><span class=\"line\">    background:lightyellow;</span><br><span class=\"line\">    overflow:hidden;</span><br><span class=\"line\">    height:116px;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<div class=\"article-img\"><p><img src=\"https://i.loli.net/2019/04/29/5cc70298911ec.png\" alt=\"5cc70298911ec.png\" data-zoomable></p></div>\n<h3 id=\"副作用\">副作用<a href=\"post/arc-19#副作用\"></a></h3><p>有很多创建 BFC 的方法都会产生一些副作用，因为我们只是利用了 BFC 的布局特性，而产生 BFC 的条件往往不仅仅如此，因此可能会让我们的代码令人迷惑，此时最好明显的给出注释或是采用没有副作用的 BFC 创建方式。</p>\n<p>使用overflow来创建一个新的BFC，是因为overflow属性告诉浏览器你想要怎样处理溢出的内容。当你使用这个属性只是为了创建BFC的时候，你可能会发现一些不想要的问题，比如滚动条或者一些剪切的阴影，需要注意。另外，对于后续的开发，可能不是很清楚当时为什么使用overflow。所以你最好添加一些注释来解释为什么这样做。</p>\n<p><strong>一个新的display属性的值，它可以创建无副作用的BFC。在父级块中使用display: flow-root可以创建新的BFC。</strong></p>\n<h2 id=\"Reference\">Reference<a href=\"post/arc-19#Reference\"></a></h2><p><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/Guide/CSS/Block_formatting_context\" target=\"_blank\" rel=\"noopener\">块格式化上下文 - Web 开发者指南 | MDN</a><br><a href=\"https://www.cnblogs.com/lhb25/p/inside-block-formatting-ontext.html\" target=\"_blank\" rel=\"noopener\">前端精选文摘：BFC 神奇背后的原理 - 梦想天空（山边小溪） - 博客园</a><br><a href=\"https://www.cnblogs.com/libin-1/p/7098468.html\" target=\"_blank\" rel=\"noopener\">什么是BFC - 最骚的就是你 - 博客园</a><br><a href=\"https://juejin.im/post/59b73d5bf265da064618731d\" target=\"_blank\" rel=\"noopener\">学习 BFC (Block Formatting Context) - 掘金</a><br><a href=\"https://github.com/zuopf769/notebook/blob/master/fe/BFC%E5%8E%9F%E7%90%86%E5%89%96%E6%9E%90/README.md\" target=\"_blank\" rel=\"noopener\">notebook/README.md at master · zuopf769/notebook · GitHub</a></p>\n","prev":{"title":"每天（不知道有几）道前端面试题（四月篇）","link":"post/arc-13"},"next":{"title":"浅谈博弈论（Nim 游戏）","link":"post/arc-18"},"plink":"https://xkeith.space/post/arc-19/","toc":[{"title":"概念","id":"概念","index":"1","children":[{"title":"创建","id":"创建","index":"1.1"},{"title":"约束规则","id":"约束规则","index":"1.2"}]},{"title":"主要应用","id":"主要应用","index":"2","children":[{"title":"清除浮动","id":"清除浮动","index":"2.1"},{"title":"防止 margin 塌陷","id":"防止-margin-塌陷","index":"2.2","children":[{"title":"单个文档流的 margin 塌陷","id":"单个文档流的-margin-塌陷","index":"2.2.1"},{"title":"嵌套元素的 margin 重叠","id":"嵌套元素的-margin-重叠","index":"2.2.2"}]},{"title":"自适应布局","id":"自适应布局","index":"2.3"},{"title":"副作用","id":"副作用","index":"2.4"}]},{"title":"Reference","id":"Reference","index":"3"}]}